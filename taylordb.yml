# yaml-language-server: $schema=https://server-vms.develop.taylordb.ai/apps/config-schema/v1

version: 1

project: blank

runtime:
  type: node
  version: 20
  packageManager: pnpm

services:
  server:
    workDir: apps/server
    install:
      commands:
        - pnpm install
    dev:
      command: pnpm dev
      port: 3000
      env:
        vars:
          TAYLORDB_BASE_URL: vars.TAYLORDB_INTERNAL_BASE_URL
          TAYLORDB_API_TOKEN: secrets.TAYLORDB_API_TOKEN
          TAYLORDB_SERVER_ID: vars.TAYLORDB_SERVER_ID
          FRONTEND_URL: routing.client.url
  
  client:
    workDir: apps/client
    install:
      commands:
        - pnpm install
    dev:
      command: pnpm dev
      port: 5173
      env:
        vars:
          VITE_TRPC_URL: routing.server.url

taylordb:
  types:
    - output: apps/server/taylordb/types.ts
      format: typescript
      onChange:
        - pnpm lint

preview:
  service: client

routing:
  - path: /api
    service: server
  - path: /
    service: client
